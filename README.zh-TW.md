[English](README.md)

---

# SillyTavern 提示詞分組（可摺疊）擴充功能

這是一個能讓 SillyTavern 的提示詞管理器（Prompt Manager）更加整潔、高效的擴充插件。透過簡單的「標頭標記」，將雜亂的提示詞清單整理為可摺疊的群組，並支援群組級別的啟用/停用控制。

## 核心功能

- **彈性分組方式**：可選擇自動標記分組或手動選擇模式。
- **手動選擇模式** **（新功能！）**：透過勾選框手動選擇哪些提示詞要成為資料夾標題 - 不需要特殊命名規則。
- **群組連動控制**：
  - **摺疊/展開**：點擊標題可收合內容。
  - **啟用/停用**：**（v2.2+ 新功能）** 當你停用（Disable）群組標題時，該群組內的所有提示詞都會被自動過濾，**不會發送給 AI**。這讓你能在不同場景間快速切換整組設定。
- **跨 Preset 複製配置** **（v2.4+ 新功能）**：可從其他 Preset 複製摺疊配置，智能名稱匹配讓你在 Preset 更新時也能輕鬆遷移設定。
- **三種摺疊模式**：支援「手動選擇」（推薦）、「標準模式」與「包覆模式」，適應不同的整理習慣。
- **批次操作**：一鍵「全部展開 / 全部收合」。
- **高度自訂**：可自訂識別標頭的符號（標準/包覆模式適用）。
- **Debug 模式**：可開啟主控台記錄功能，方便開發與除錯。
- **零相依性**：輕量級設計，安裝即用。

## 摺疊模式說明

本插件支援三種模式，可在設定面板中即時切換：

### 1. 手動選擇模式（推薦）👍
*v2.3+ 新增*

最彈性的模式。在設定中點擊「開始選擇資料夾」，然後勾選要當作資料夾標題的提示詞即可。不需要特殊命名。

* **使用方式：**
  1. 開啟設定（⚙️ 按鈕）
  2. 點擊「開始選擇資料夾」
  3. 勾選要當作資料夾標題的提示詞
  4. 點擊「完成選擇」
* 適合：最大彈性與易用性。

### 2. 標準模式
最直覺的模式。當程式找到一個標頭時，會將其後方所有的提示詞納入該群組，直到遇到下一個標頭為止。
* 適合：依功能分類的長清單。
* **需要：** 提示詞名稱以分隔符號開頭（例如 `==主要設定`、`---工具`）

### 3. 包覆模式 (Sandwich Mode)
需要一對完全相同的標頭（例如開始與結束標記）。程式會將這兩個標頭之間的所有內容摺疊起來。
* 適合：像是「第一章」、「特定場景」這種有明確範圍的區塊。
* **需要：** 成對的標頭
* **範例：**
  ```text
  ==== 戰鬥模組 ====  <-- 標題 (Start)
  攻擊邏輯 A
  防禦邏輯 B
  ==== 戰鬥模組 ====  <-- 標題 (End)
  ```

## 使用教學

### 快速開始（手動選擇模式）

1.  **選擇資料夾標題**：
      - 開啟設定（⚙️ 按鈕）
      - 點擊「開始選擇資料夾」
      - 勾選要當作資料夾的提示詞
      - 點擊「完成選擇」

2.  **管理群組**：
      - **點擊箭頭或空白處**：展開或收合群組。
      - **點擊文字名稱**：開啟提示詞編輯器（保留原本功能）。
      - **點擊開關（原生的 Enable/Disable）**：若關閉標題的開關，群組內的提示詞會呈現灰色半透明狀，代表它們暫時失效（不會被發送）。

3.  **工具列按鈕**：
      - `⬇️` / `⬆️`：全部展開或收合。
      - `🔴` / `🟢`：暫時停用或啟用此擴充功能（不影響提示詞本身，僅影響分組顯示）。
      - `⚙️`：開啟設定面板，切換模式、自訂分隔符號或開啟 Debug 模式。

4.  **跨 Preset 複製配置** **（v2.4+ 新功能）**：
      - 開啟設定面板（⚙️ 按鈕）
      - 在「從其他 Preset 複製配置」區塊選擇來源 Preset
      - 點擊「複製」按鈕
      - 系統會自動透過條目名稱匹配，將摺疊配置套用到當前 Preset
      - **適用場景**：當 Preset 作者更新預設時，雖然 UUID 改變了，但條目名稱相同，就能快速遷移你的摺疊設定

### 舊版模式（標準/包覆模式）

若使用標準或包覆模式：
- 在 Prompt Manager 中新增一個提示詞。
- 將其命名為以標記符號開頭（預設為 `=` 或 `-`），例如 `= 主要設定`。
- 將其拖曳到你想要分組的提示詞上方。

## 安裝方式

1.  複製儲存庫連結：`https://github.com/lilminzyu/ST-PromptFolding`
2.  在 SillyTavern 介面中開啟【Extensions】分頁。
3.  點擊右上角【Install Extension】。
4.  貼上連結並安裝。
5.  安裝後請確認 **Prompt Folding** 已啟用。

## 授權

本專案依 [LICENSE](LICENSE) 條款授權。